<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>You live in a city with <b>N</b> intersections, numbered 1 through <b>N</b>. There are some roads in the city. Each road is bidirectional and connects two intersections. There are no loops and each pair of intersections is connected by at most one road. The road network is connected - that is, one can travel between any two intersections.</p>
<br></br>
<p>A special feature of this city is that some of the roads have no speed limits, and everyone drives along those roads at an insane speed. For the purpose of this problem, we will simply assume that these roads can be traversed instantly, in zero time.</p>
<br></br>
<p>You are given the int <b>N</b> and three vector &lt;int&gt;s <b>A</b>, <b>B</b>, and <b>C</b>, each with the same number of elements. The vector &lt;int&gt;s <b>A</b>, <b>B</b>, and <b>C</b> describe the road network: For each valid i, there is a bidirectional road that connects the intersections <b>A</b>[i] and <b>B</b>[i], and it takes <b>C</b>[i] seconds to traverse that road in either direction.</p>
<br></br>
<p>You are currently at the intersection 1 and you want to travel to the intersection <b>N</b> as quickly as possible. Count all ways of doing so, and return that count modulo 1,000,000,009. If there are infinitely many ways, return -1 instead. (Two ways are considered different if the sequences of visited intersections differ. Note that it is allowed to enter any intersection, including intersections 1 and <b>N</b>, multiple times.)</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>DrivingPlans</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>int, vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(int N, vector &lt;int&gt; A, vector &lt;int&gt; B, vector &lt;int&gt; C)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>N</b> will be between 2 and 2,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>A</b>, <b>B</b> and <b>C</b> will contain between 1 and 2,000 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>A</b>, <b>B</b> and <b>C</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>A</b> and <b>B</b> will be between 1 and <b>N</b>, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>C</b> will be between 0 and 100,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each valid i, <b>A</b>[i] will be different from <b>B</b>[i].</td></tr><tr><td align="center" valign="top">-</td><td>No two roads will connect the same pair of intersections.</td></tr><tr><td align="center" valign="top">-</td><td>The road network will be connected.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>{1,1,2,3}</pre></td></tr><tr><td><pre>{2,3,4,4}</pre></td></tr><tr><td><pre>{1,1,1,1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">There are exactly two shortest ways of travel: 1-2-4 and 1-3-4.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>{1,1,2,3}</pre></td></tr><tr><td><pre>{2,3,4,4}</pre></td></tr><tr><td><pre>{1,1,1,0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: -1</pre></td></tr><tr><td><table><tr><td colspan="2">Remember that each road can be used in both directions. In this case, there are infinitely many ways how to reach the intersection 4 in shortest time. For example, you can go 1-2-4, or 1-2-4-3-4, or 1-2-4-3-4-3-4, etc.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>7</pre></td></tr><tr><td><pre>{1,1,2,3,4,4,5,6}</pre></td></tr><tr><td><pre>{2,3,4,4,5,6,7,7}</pre></td></tr><tr><td><pre>{1,1,2,2,3,3,4,4}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
